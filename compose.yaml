version: "3.9"

services:
  jupyter:
    image: jupyter/scipy-notebook:latest
    ports:
      - "8888:8888"
    volumes:
      - jupyter-data:/home/jovyan/work
      - ./notebooks:/home/jovyan/notebooks:rw
    environment:
      - JUPYTER_ENABLE_LAB=yes
      - JUPYTER_TOKEN=${JUPYTER_TOKEN:-changeme}
    mem_limit: 4g
    cpus: "2"
    healthcheck:                       # â† option A shown here
      test: ["CMD-SHELL", "curl -sf http://localhost:8888/api | grep -q 'version'"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 30s
    restart: unless-stopped
    labels:
      com.jupyter.description: "Jupyter Notebook Server"
      com.jupyter.environment: "homelab"
    command: >
      start-notebook.sh
      --ServerApp.jpserver_extensions="{'jupyter_server.nbconvert': True}"
      --ServerApp.token=''
      --ServerApp.password=''

volumes:
  jupyter-data:
